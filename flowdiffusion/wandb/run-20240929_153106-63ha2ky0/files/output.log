Preparing dataset...
Done

  0%|                                                                                            | 3/30000 [00:03<7:53:23,  1.06it/s]
dec_out in vqvae.py: tensor([[ 1.2140, -0.4961, -0.6340,  ..., -0.6207,  0.0253, -0.7249],
        [ 0.4298,  0.1151, -0.2499,  ..., -0.3240, -0.5449, -0.3217],
        [-0.9150, -0.5672,  0.1659,  ..., -0.0014, -1.3797,  1.0352],
        ...,
        [ 0.2725,  0.1984, -0.1976,  ...,  0.0926,  0.4119,  0.9396],
        [-0.9150, -0.5672,  0.1659,  ..., -0.0014, -1.3797,  1.0352],
        [-0.9150, -0.5672,  0.1659,  ..., -0.0014, -1.3797,  1.0352]],
       device='cuda:0', grad_fn=<NativeBatchNormBackward0>)
state in vqvae.py: tensor([[ 1.2188e-01,  6.8388e-02,  2.1304e-01,  ...,  0.0000e+00,
          0.0000e+00,  1.0000e-01],
        [-1.6444e-03,  2.8063e-02, -1.1993e-01,  ..., -1.6053e-02,
         -1.2082e-01,  1.0000e-01],
        [-6.0245e-04, -9.8325e-04, -2.3587e-02,  ..., -1.3322e-03,
         -2.2292e-02,  8.0000e-02],
        ...,
        [ 1.5585e-03,  1.4840e-01,  2.7367e-03,  ...,  1.3630e-01,
          4.4854e-03,  0.0000e+00],
        [-2.4850e-04, -2.1272e-04, -8.1412e-02,  ..., -4.3635e-03,
         -3.1996e-02,  6.0000e-02],
        [ 0.0000e+00,  0.0000e+00,  1.0662e-02,  ...,  0.0000e+00,
          9.2418e-03,  6.0000e-02]], device='cuda:0')
dec_out in vqvae.py: tensor([[-0.4035, -0.1731, -0.2673,  ...,  0.1912, -0.2639,  1.1093],
        [ 0.0640,  0.2201,  0.5237,  ...,  0.7660, -0.1940, -0.2940],
        [ 0.4628, -0.2650, -0.1573,  ..., -0.4649, -0.2757, -1.0471],
        ...,
        [-0.3784,  0.6577,  0.3380,  ...,  0.4205, -0.0647, -0.7414],
        [-0.0233,  0.7208,  0.8266,  ...,  0.7128, -0.2439, -0.5526],
        [-0.5426,  0.2363, -0.2070,  ...,  0.0494, -0.6638,  0.8216]],
       device='cuda:0', grad_fn=<NativeBatchNormBackward0>)
state in vqvae.py: tensor([[-0.0051,  0.0106, -0.1642,  ...,  0.0065, -0.1276,  0.0000],
        [-0.1954,  0.0187, -0.0223,  ...,  0.0190, -0.0088,  0.1000],
        [-0.0128,  0.4738, -0.0075,  ...,  0.3422, -0.0098,  0.0000],
        ...,
        [-0.0107,  0.1262,  0.0021,  ...,  0.0000,  0.0000,  0.0000],
        [-0.1885,  0.0209, -0.0097,  ...,  0.0000,  0.0000,  0.1000],
        [ 0.2468,  0.1035, -0.0578,  ...,  0.0436,  0.0227,  0.1000]],
       device='cuda:0')
dec_out in vqvae.py: tensor([[-0.5443,  0.3615, -0.1825,  ...,  0.4219, -0.4246,  0.3285],
        [-0.5407,  0.4320, -0.2131,  ...,  0.3686, -0.4753,  0.3855],
        [ 2.1475, -2.1902, -1.6718,  ..., -2.3310,  1.1385, -0.4156],
        ...,
        [-0.0996,  0.8038,  0.9116,  ...,  0.2593,  0.4354, -0.0348],
        [ 0.2887, -0.0712,  1.2233,  ...,  0.1401, -0.5611, -1.3307],
        [-0.5675,  0.4934, -0.2346,  ...,  0.4688, -0.3875,  0.6446]],
       device='cuda:0', grad_fn=<NativeBatchNormBackward0>)
state in vqvae.py: tensor([[-1.5155e-03, -3.6959e-02, -9.1629e-02,  ...,  0.0000e+00,
          0.0000e+00,  1.0000e-01],
        [ 2.2136e-01,  3.3602e-02,  2.0257e-02,  ...,  4.3637e-02,
          2.2115e-02,  1.0000e-01],
        [ 7.4383e-03,  3.3122e-02, -1.2313e+00,  ...,  2.5910e-02,
         -1.2299e+00, -1.0000e-01],
        ...,
        [ 0.0000e+00,  0.0000e+00,  7.2859e-01,  ...,  0.0000e+00,
          6.2991e-01,  6.0000e-02],
        [-6.4579e-01,  1.3649e+00,  4.8200e-01,  ...,  1.0878e+00,
          4.1146e-01,  1.0000e-01],
        [-4.6862e-03,  1.7209e-01, -4.3554e-04,  ...,  1.1674e-01,
         -1.9062e-03,  8.0000e-02]], device='cuda:0')
dec_out in vqvae.py: tensor([[-0.4308,  0.3128, -0.0162,  ...,  0.1486, -0.2611,  0.5067],
        [ 4.4468, -4.4550, -3.6597,  ..., -4.1753,  1.2659, -2.4436],
        [-0.1861,  0.2079, -0.0594,  ...,  0.5640, -0.4019,  0.5187],
        ...,
        [ 0.3618, -0.1297,  1.7545,  ..., -0.7926,  2.4629, -2.2475],
        [-0.0960,  0.3274, -0.1046,  ...,  0.7279, -0.2968, -0.0237],
        [ 2.8012, -2.9388, -2.5031,  ..., -2.9342,  0.8060, -0.8562]],
       device='cuda:0', grad_fn=<NativeBatchNormBackward0>)
state in vqvae.py: tensor([[ 5.7631e-01, -6.5527e-02, -1.2907e-02,  ...,  0.0000e+00,
          0.0000e+00,  1.0000e-01],
        [-7.1166e-03,  1.5301e-03, -1.4753e+00,  ..., -1.3319e-02,
         -1.3248e+00, -1.0000e-01],
        [-3.1751e-01,  2.3328e-01, -1.2541e-02,  ...,  9.2457e-02,
         -5.6555e-03,  1.0000e-01],
        ...,
        [ 7.2527e-01,  8.3118e-01, -1.6252e-01,  ...,  6.3076e-01,
         -1.5720e-01,  1.0000e-01],
        [-1.3411e-01, -6.5143e-02, -2.1128e-02,  ..., -7.2712e-02,
          4.4337e-02,  1.0000e-01],
        [ 4.4850e-02,  1.0462e-01, -3.9489e-02,  ..., -2.7675e-02,
         -1.7580e+00, -1.0000e-01]], device='cuda:0')
dec_out in vqvae.py: tensor([[-0.3914,  0.0772, -0.1766,  ...,  0.8901, -0.4455,  0.4861],
        [-0.7204,  0.2990,  0.0459,  ...,  0.6585, -0.4291,  0.6272],
        [-0.8821,  0.0605, -0.2181,  ...,  0.5036, -0.2720, -0.0347],
        ...,
        [-0.8821,  0.0605, -0.2181,  ...,  0.5036, -0.2720, -0.0347],
        [ 0.5930, -1.2858, -0.6847,  ..., -0.3797, -0.5376,  0.6040],
        [ 3.0394, -3.8248, -2.8025,  ..., -3.2812, -0.0297,  0.0182]],
       device='cuda:0', grad_fn=<NativeBatchNormBackward0>)
state in vqvae.py: tensor([[-2.7821e-01,  1.3361e-01, -6.9177e-03,  ...,  1.7833e-01,
          9.0794e-03,  1.0000e-01],
        [-1.1142e-03,  1.4332e-01,  3.7846e-03,  ...,  1.2222e-01,
          3.1980e-03,  0.0000e+00],
        [-6.4788e-02,  3.5975e-02,  1.9424e-02,  ...,  1.7617e-02,
          8.7398e-03,  0.0000e+00],
        ...,
        [-4.7049e-03,  7.0796e-02, -4.0696e-02,  ...,  3.9624e-02,
         -4.6136e-02,  6.0000e-02],
        [-1.2847e-03,  2.8302e-01, -4.0968e-01,  ...,  1.5239e-01,
         -3.9042e-01,  1.0000e-01],
        [ 2.5233e-04, -4.2981e-02, -4.9861e-01,  ...,  1.6373e-03,
         -3.5663e-01, -1.0000e-01]], device='cuda:0')
dec_out in vqvae.py: tensor([[ 1.7369, -2.1379, -2.0754,  ..., -2.1386, -0.3558, -0.4300],
        [-0.4670,  0.0815,  0.1024,  ...,  0.3839, -0.2496,  0.4720],
        [-0.0441,  0.2292,  0.2130,  ...,  0.7896, -0.3427,  0.5443],
        ...,
        [-0.6142,  0.2433,  0.1410,  ...,  0.2966, -0.2877,  0.5706],
        [ 0.6623,  0.9516,  0.9846,  ..., -0.4895,  2.5850, -1.5455],
        [ 0.7753, -1.3491, -0.9995,  ..., -0.8169, -0.3463,  0.6521]],
       device='cuda:0', grad_fn=<NativeBatchNormBackward0>)
state in vqvae.py: tensor([[ 9.1345e-02,  2.2367e-02,  3.1766e-01,  ..., -6.7545e-03,
         -1.5086e+00, -1.0000e-01],
        [-1.9454e-02, -9.8186e-03, -2.4596e-01,  ..., -7.8226e-02,
         -9.5259e-02,  1.0000e-01],
        [-2.4220e-01,  2.7752e-01,  1.3957e-01,  ...,  1.1173e-01,
          1.4290e-02, -1.0000e-01],
        ...,
        [ 0.0000e+00,  1.2500e-01,  0.0000e+00,  ...,  1.2500e-01,
          0.0000e+00,  7.0000e-02],
        [ 9.4416e-01,  3.2119e-02,  3.3477e-03,  ..., -3.2928e-02,
         -1.5276e-03,  1.0000e-01],
        [-1.2013e-01,  5.9454e-03, -3.0545e-02,  ...,  1.1032e-03,

  0%|                                                                                           | 6/30000 [00:08<11:46:14,  1.41s/it]
Traceback (most recent call last):
  File "/home/yyang-infobai/AVDC_whl/flowdiffusion/pretrain.py", line 100, in <module>
    main(cfg)
  File "/home/yyang-infobai/AVDC_whl/flowdiffusion/pretrain.py", line 75, in main
    x, x_cond, goal, action = next(dl)
  File "/home/yyang-infobai/AVDC_whl/flowdiffusion/pretrain.py", line 24, in cycle
    for data in dl:
  File "/group/ycyang/anaconda3/envs/avdc/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/group/ycyang/anaconda3/envs/avdc/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/group/ycyang/anaconda3/envs/avdc/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1283, in _get_data
    success, data = self._try_get_data()
  File "/group/ycyang/anaconda3/envs/avdc/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/group/ycyang/anaconda3/envs/avdc/lib/python3.9/queue.py", line 180, in get
    self.not_empty.wait(remaining)
  File "/group/ycyang/anaconda3/envs/avdc/lib/python3.9/threading.py", line 316, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt